<!DOCTYPE html>
<html>
	<head>
		<title>PBNify</title>

		<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
		<script src="bower_components/angular/angular.js"></script>
		<script src="bower_components/lodash/lodash.js"></script>
		<!--<script src="bower_components/bootstrap/dist/js/bootstrap.js"></script>-->
		<link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.css">
		<script src="app/app.js"></script>
		<link rel="stylesheet" href="app/app.css">
	</head>

	<body ng-app="pbn" ng-controller="pbnCtrl">

		<!-- <button ng-click="loadImage()">select image</button> -->
		<!-- <input type="file" ng-file-select="onFileSelect($files)"> -->

		<!-- <img ng-src="{{ imageSrc }}"> -->

		<div class="row">
			<div class="col-md-10 col-md-offset-1" id="header">
				<span id="title">PBNify</span>
				<span id="subtitle">custom paint by number generator</span>
			</div>
		</div>

		<div class="row">
			<div class="col-md-10 col-md-offset-1" id="description">
				<p ng-class="{ 'other-step': step != 'load' }">1. Load an image</p>
				<p ng-class="{ 'other-step': step != 'select' }">2. Click some points on the image to select your color palette</p>
				<p ng-class="{ 'other-step': step != 'select' || palette.length < 2 }">3. Click PBNify and the image will be converted to a paint by number template</p>
				<p ng-class="{ 'other-step': step != 'result' }">4. Save the outline, print it out, and paint/color it</p>
				<p ng-class="'other-step'"><em>Privacy note: Your image will only be loaded into the browser on your computer. Nothing will be uploaded anywhere.</em></p>
			</div>
		</div>

		<div class="row">
			<div class="col-md-10 col-md-offset-1">
				<div id="holder" ng-show="step == 'load'" ng-style="holderStyle" image-loaded="imageLoaded(img)" load-file>
					<p>Drop image here to load, or browse for image.</p>
					<input type="file" id="fileBrowser">
				</div>
			</div>
		</div>

		<div class="row">
			<div id="toolbar" class="col-md-10 col-md-offset-1">
				<div id="buttons" ng-show="step != 'process'">
					<div type="button" class="btn btn-default" ng-click="newImage()" ng-show="step == 'select' || step == 'result'">new image</div>
					<div type="button" class="btn btn-default" ng-click="clearPalette()" ng-show="step == 'select' && palette.length > 0">clear palette</div>
					<div type="button" class="btn btn-primary" ng-click="pbnify()" ng-show="step == 'select' && palette.length > 1">PBNify</div>
					<div type="button" class="btn btn-default" ng-click="recolor()" ng-show="step == 'result'">recolor</div>
					<div class="btn-group" role="group" ng-show="step == 'result'">
						<div type="button" class="btn btn-primary" ng-click="viewFilled()" ng-show="step == 'result'">filled</div>
						<a id="save-filled" type="button" class="btn btn-success" ng-click="saveFilled()">save</a>
					</div>
					<div class="btn-group" role="group" ng-show="step == 'result'">
						<div type="button" class="btn btn-primary" ng-click="viewOutline()" ng-show="step == 'result'">outline</div>
						<a id="save-outline" type="button" class="btn btn-success" ng-click="saveOutline()">save</a>
					</div>
					<a id="save-palette" type="button" class="btn btn-success" ng-click="savePalette()" ng-show="step == 'result'">save palette</a>
				</div>
				<div ng-show="step == 'process'"><img id="spinner" src="images/spinner.png"> {{ status }}</div>
			</div>
		</div>

		<div class="row">
			<div id="palette" class="col-md-10 col-md-offset-1">
				<div class="swatch" ng-repeat="color in palette" style="background-color: rgb({{ color.r }},{{ color.g }},{{color.b}});">
					<div class="swatch-label" ng-show="step == 'result' && view == 'outline'">{{ $index + 1 }}</div>
					<img ng-click="removeColor(color)" ng-show="step == 'select'" src="images/delete.png">
				</div>
			</div>
		</div>

		<div class="row" id="canvases">
			<div class="canvas-container col-md-10 col-md-offset-1" ng-show="step == 'select' || step == 'process'">
				<canvas id="img-canvas" stage></canvas>
				<div class="sample-point" ng-repeat="color in palette" style="left: {{ color.x - 5 | number: 0 }}px; top: {{ color.y - 5 | number: 0}}px;"></div>
			</div>

			<div class="canvas-container col-md-10 col-md-offset-1" ng-show="step == 'result' && view == 'filled'">
				<canvas id="filled-canvas" result></canvas>
			</div>

			<div class="canvas-container col-md-10 col-md-offset-1" ng-show="step == 'result' && view == 'outline'">
				<canvas id="outline-canvas" result></canvas>
			</div>
		</div>

		<div class="row">
			<div id="footer" class="col-md-10 col-md-offset-1">
				<p>Email <a href="mailto:munro.daniel@gmail.com">munro.daniel@gmail.com</a> with questions, comments, or bug reports.</p>
			</div>
		</div>
	</body>
</html>